<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.chart.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>
<?import javafx.geometry.Insets?>
<?import javafx.geometry.Pos?>

<BorderPane xmlns="http://javafx.com/javafx/17"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.fittrack.controller.DashboardController"
            stylesheets="@styleSheet.css">

    <!-- === RESPONSIVE TOPBAR === -->
    <top>
        <HBox spacing="15.0" alignment="CENTER_LEFT"
              styleClass="topbar"
              style="-fx-background-color: #0D47A1; -fx-padding: 10 20;">

            <!-- User greeting -->
            <Label fx:id="userLabel" text="Welcome, User!" textFill="WHITE">
                <font>
                    <Font name="System Bold" size="18.0"/>
                </font>
            </Label>

            <Separator orientation="VERTICAL" style="-fx-background-color: white;"/>

            <!-- Navigation Buttons -->
            <HBox spacing="10.0" alignment="CENTER_LEFT">
                <Button text="ðŸ‘¤ My Profile" onAction="#handleProfileButtonAction" styleClass="sidebar-button"/>
                <Button text="ðŸŽ¯ My Goals" onAction="#handleGoalsButtonAction" styleClass="sidebar-button"/>
                <Button text="ðŸ“… Schedule" onAction="#handleWorkoutPlansButtonAction" styleClass="sidebar-button"/>
                <Button text="ðŸ“ˆ Progress" onAction="#handleProgressButtonAction" styleClass="sidebar-button"/>
                <Button text="ðŸŽ Food Log" onAction="#handleFoodLogButtonAction" styleClass="sidebar-button"/>
            </HBox>

            <Pane HBox.hgrow="ALWAYS"/>

            <!-- Logout button on far right -->
            <Button text="ðŸšª Logout" onAction="#handleLogoutButtonAction" styleClass="logout-button"/>
        </HBox>
    </top>

    <!-- === MAIN CONTENT (Dashboard sample layout) === -->
    <center>
        <ScrollPane fitToWidth="true" fitToHeight="true"
                    hbarPolicy="AS_NEEDED" vbarPolicy="AS_NEEDED"
                    style="-fx-background-color: transparent;">
            <VBox alignment="TOP_CENTER" spacing="25.0" fillWidth="true" styleClass="dashboard-container">
                <padding>
                    <Insets top="20" left="40" right="40" bottom="20"/>
                </padding>

                <!-- Heading -->
                <Label text="Hey there, User!" styleClass="title"/>
                <Separator prefWidth="800" style="-fx-border-color: #2C3E50; -fx-border-width: 0 0 2 0;"/>

                <!-- Two-column grid: left = icon buttons, right = large cards -->
                <GridPane hgap="30" vgap="20">
                    <columnConstraints>
                        <ColumnConstraints minWidth="200" prefWidth="240" />
                        <ColumnConstraints hgrow="ALWAYS" />
                    </columnConstraints>

                    <!-- Row 0: Statistics button + big card -->
                    <Button fx:id="statsButton" GridPane.rowIndex="0" GridPane.columnIndex="0"
                            onAction="#handleStatsButtonAction" styleClass="dashboard-square">
                        <graphic>
                            <VBox alignment="CENTER" spacing="8">
                                <Label text="ðŸ“Š" styleClass="dashboard-icon"/>
                                <Label text="MY STATISTICS" styleClass="dashboard-icon-label"/>
                            </VBox>
                        </graphic>
                    </Button>
                    <StackPane GridPane.rowIndex="0" GridPane.columnIndex="1" styleClass="dashboard-card" prefHeight="180">
                        <children>
                            <!-- Stats label targeted by DashboardController -->
                            <ScrollPane fitToWidth="true" fitToHeight="true" style="-fx-background-color: transparent;">
                                <content>
                                    <Label fx:id="statsLabel" text="No stats available"
                                           wrapText="true"
                                           style="-fx-font-size: 14px; -fx-text-fill: #333333; -fx-padding: 6;"/>
                                </content>
                            </ScrollPane>
                        </children>
                    </StackPane>

                    <!-- Row 1: Exercises button + big card -->
                    <Button fx:id="exercisesButton" GridPane.rowIndex="1" GridPane.columnIndex="0"
                            onAction="#handleExercisesButtonAction" styleClass="dashboard-square">
                        <graphic>
                            <VBox alignment="CENTER" spacing="8">
                                <Label text="ðŸ“" styleClass="dashboard-icon"/>
                                <Label text="MY EXERCISES" styleClass="dashboard-icon-label"/>
                            </VBox>
                        </graphic>
                    </Button>

                    <StackPane GridPane.rowIndex="1" GridPane.columnIndex="1" styleClass="dashboard-card" prefHeight="220">
                        <children>
                            <!-- Today's Workout Table restored so controller can bind columns -->
                            <TableView fx:id="todayWorkoutTable" prefHeight="180" style="-fx-background-color: white; -fx-border-color: transparent;">
                                <columnResizePolicy>
                                    <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                                </columnResizePolicy>
                                <columns>
                                    <TableColumn fx:id="exerciseColumn" text="Exercise" />
                                    <TableColumn fx:id="setsColumn" text="Sets" />
                                    <TableColumn fx:id="repsColumn" text="Reps" />
                                    <TableColumn fx:id="weightColumn" text="Weight (kg)" />
                                </columns>
                                <placeholder>
                                    <VBox alignment="CENTER" spacing="8" style="-fx-padding: 12;">
                                        <Label text="No workouts for today" style="-fx-text-fill: #666666; -fx-font-size: 13px;" />
                                    </VBox>
                                </placeholder>
                            </TableView>
                        </children>
                    </StackPane>
                </GridPane>

            </VBox>
        </ScrollPane>
    </center>
</BorderPane>
